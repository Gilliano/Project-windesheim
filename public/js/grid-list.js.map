{"version":3,"sources":["grid-list_fixtures.js","grid-list_init.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACtEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"grid-list.js","sourcesContent":["// Class for easily creating grid elements\r\n// TODO: Add save (serialize) function to serialize all gridItems(with their pos) to a cookie\r\nclass GridItem {\r\n    constructor(width, height, x, y, image = null, link = null){\r\n        this.id = gridItems.length; // Make sure it has a unique id\r\n        this.width = width;\r\n        this.height = height;\r\n        this.x = x;\r\n        this.y = y;\r\n        this.image = image;\r\n        this.link = link;\r\n        this.createHTML(link, image);\r\n\r\n        // Push this object to the gridItems list\r\n        gridItems.push(this);\r\n    }\r\n\r\n    createHTML(link = null, image = null){\r\n        this.html = $(\r\n            '<li data-id='+this.id+'>' +\r\n                '<div class=\"inner\">' +\r\n                    '<div class=\"controls\">' +\r\n                        '<a href=\"#zoom1\" class=\"edit\" data-a=\"resize\" data-w=\"1\" data-h=\"1\">1x1</a>' +\r\n                        '<a href=\"#zoom2\" class=\"edit\" data-a=\"resize\" data-w=\"2\" data-h=\"1\">2x1</a>' +\r\n                        '<a href=\"#zoom1\" class=\"edit\" data-a=\"resize\" data-w=\"1\" data-h=\"2\">1x2</a>' +\r\n                        '<a href=\"#zoom2\" class=\"edit\" data-a=\"resize\" data-w=\"2\" data-h=\"2\">2x2</a>' +\r\n                        '<a href=\"#edit\" class=\"edit\" data-a=\"edit\">edit</a>' +\r\n                    '</div>' +\r\n                    (link!==(null)?'<a href='+link+'>':'') +\r\n                        (image!==(null)?'<img src='+image+' class=\"image\">':'<div style=\"width:100%; height:100%; background-color: '+randomColor('rgb')+'\"></div>') +\r\n                    (link!==(null)?'</a>':'') +\r\n                '</div>' +\r\n            '</li>'\r\n        );\r\n    }\r\n\r\n    toJSON(){\r\n        return {\r\n            id: this.id,\r\n            width: this.width,\r\n            height: this.height,\r\n            x: this.x,\r\n            y: this.y,\r\n            image: this.image,\r\n            link: this.link,\r\n            // html: this.html\r\n        };\r\n    }\r\n}\r\n\r\nvar gridItems = [];\r\nvar fixtures = {};\r\n\r\nfixtures.GRID1 = [\r\n        new GridItem(1,1,0,0,\"https://www.nasa.gov/sites/default/files/styles/image_card_4x3_ratio/public/thumbnails/image/leisa_christmas_false_color.png?itok=Jxf0IlS4\", \"https://www.google.com\"),\r\n        new GridItem(1,2,1,0),\r\n        new GridItem(1,1,2,0),\r\n        new GridItem(1,1,3,0),\r\n        new GridItem(1,1,4,0),\r\n        new GridItem(1,1,0,1),\r\n        new GridItem(1,1,2,1),\r\n        new GridItem(1,1,3,1),\r\n    ];\r\n\r\n// Enable Node module\r\nif (typeof(require) == 'function') {\r\n    for (var k in fixtures) {\r\n        exports[k] = fixtures[k];\r\n    }\r\n}\r\n","$(document).ready(function(){\r\n    createGrid(fixtures.GRID1);\r\n});\r\n\r\nvar Grid = {\r\n    currentSize: 4, // Amount of rows\r\n    buildElements: function($gridContainer, items) { // Create the items\r\n        var item, i;\r\n        for (i = 0; i < items.length; i++) {\r\n            item = items[i];\r\n            $item = item.html;\r\n            $item.attr({\r\n                'data-w': item.width,\r\n                'data-h': item.height,\r\n                'data-x': item.x,\r\n                'data-y': item.y\r\n            });\r\n            $gridContainer.append($item);\r\n        }\r\n    },\r\n    resize: function(size) {\r\n        if (size) {\r\n            this.currentSize = size;\r\n        }\r\n        $('#grid').gridList('resize', this.currentSize);\r\n    },\r\n    // flashItems: function(items) {\r\n    //     // Hack to flash changed items visually\r\n    //     for (var i = 0; i < items.length; i++) {\r\n    //         (function($element) {\r\n    //             $element.addClass('changed');\r\n    //             setTimeout(function() {\r\n    //                 $element.removeClass('changed');\r\n    //             }, 0);\r\n    //         })(items[i].$element);\r\n    //     }\r\n    // }\r\n};\r\n\r\n$(window).resize(function() {\r\n    $('#grid').gridList('reflow');\r\n});\r\n\r\nfunction createGrid(itemCollection) {\r\n    // Clear the grid\r\n    $(\"#grid\").empty();\r\n\r\n    // Build the items\r\n    Grid.buildElements($('#grid'), itemCollection);\r\n\r\n    // Convert the UL to a gridList\r\n    $('#grid').gridList({\r\n        lanes: Grid.currentSize,\r\n        widthHeightRatio: 264 / 294,\r\n        heightToFontSizeRatio: 0.25,\r\n        onChange: function(changedItems) {\r\n            // Save the new positions to the objects\r\n            $.each(changedItems, function(index, item){\r\n                var gridItem = gridItems[item.id];\r\n                gridItem.x = item.x;\r\n                gridItem.y = item.y;\r\n                gridItems[gridItem.id] = gridItem;\r\n            });\r\n\r\n            // Convert to JSON\r\n            // console.log(JSON.stringify(gridItems));\r\n            // TODO: Save the JSON string to a cookie\r\n            var username = 'JohnDoe'; // TODO: Get logged in username\r\n            var grid = JSON.stringify(gridItems);\r\n\r\n            var date_obj = new Date();\r\n            date_obj.setMonth(date_obj.getMonth() + 1); // Define lifetime of the cookie\r\n            var exp_date = date_obj.toUTCString();//.setMonth(new Date().getMonth() + 1);//.toUTCString();\r\n            console.log(exp_date);\r\n        }\r\n    });\r\n\r\n    // Eventhandler for the control buttons\r\n    $('#grid li .edit').click(function(e) {\r\n        e.preventDefault();\r\n        var itemElement = $(e.currentTarget).closest('li');\r\n        var gridItem = gridItems[itemElement.data('id')];\r\n        var itemAction = $(e.currentTarget).data('a');\r\n\r\n        if(itemAction == 'resize')\r\n        {\r\n            // Resize grid item according to given data\r\n            $('#grid').gridList('resizeItem', itemElement, {\r\n                w: $(e.currentTarget).data('w'),\r\n                h: $(e.currentTarget).data('h')\r\n            });\r\n\r\n            // Save the changes to the object\r\n            gridItem.width = $(e.currentTarget).data('w');\r\n            gridItem.height = $(e.currentTarget).data('h');\r\n            // gridItem.createHTML();\r\n            gridItems[gridItem.id] = gridItem;\r\n        }\r\n        else if(itemAction == 'edit')\r\n        {\r\n            // Open modal to edit the grid items properties\r\n            $(\"#edit_id\").val(gridItem.id);\r\n            $(\"#edit_link\").val(gridItem.link!==(null)?gridItem.link:'');\r\n            $(\"#edit_image\").val(gridItem.image!==(null)?gridItem.image:'');\r\n            $(\"#modal_edit\").modal('show');\r\n        }\r\n    });\r\n\r\n    // Eventhandler for saving edit modal\r\n    $('#edit_save').on('click', function(e){\r\n        // Update grid item and refresh the grid\r\n        // TODO: Expand Form validation\r\n        // TODO: Improve performance\r\n        var gridItem = gridItems[$(\"#edit_id\").val()];\r\n        var link = null, image = null;\r\n        if($(\"#edit_link\").val() != '')\r\n            link = $(\"#edit_link\").val(); // TODO: Check if we need to add 'http' prefix? Otherwise laravel returns an error...\r\n        if($(\"#edit_image\").val() != '')\r\n            image = $(\"#edit_image\").val();\r\n        gridItem.createHTML(link, image);\r\n        gridItems[gridItem.id] = gridItem;\r\n\r\n        // Recreate the grid\r\n        createGrid(gridItems);\r\n\r\n        // Hide the modal\r\n        $(\"#modal_edit\").modal('hide');\r\n    });\r\n\r\n    //// Adds a row to the grid\r\n    // $('.add-row').click(function(e) {\r\n    //     e.preventDefault();\r\n    //     Grid.resize(Grid.currentSize + 1);\r\n    // });\r\n\r\n    //// Removes a row from the grid\r\n    // $('.remove-row').click(function(e) {\r\n    //     e.preventDefault();\r\n    //     Grid.resize(Math.max(1, Grid.currentSize - 1));\r\n    // });\r\n};"]}